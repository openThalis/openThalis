<!DOCTYPE html>
<html>
<head>
    <title>Tasks</title>
    <link rel="stylesheet" href="/programs/eidos/tasks/tasks.css">
</head>
<body>
    <div class="tasks-container">
        <div class="tasks-main">
            <div class="tasks-wrapper">
                <div class="tasks-header">
                    <h1 class="tasks-title">Tasks</h1>
                    <button id="addTaskBtn" class="add-task-btn">
                        <span class="add-icon">+</span>
                        Add new
                    </button>
                </div>
                
                <div class="task-list" id="taskList">

                </div>
            </div>
        </div>
        
        <!-- Sidebar for task details and settings -->
        <div class="tasks-sidebar hidden" id="tasksSidebar">
            <div class="sidebar-content">
                <!-- Task Settings Panel -->
                <div id="taskSettings" class="sidebar-panel task-settings-panel hidden">
                    <div class="panel-header">
                        <div id="taskSettingsActionButtons" class="task-settings-action-buttons hidden">
                            <button id="taskSettingsRunStopBtn" class="task-settings-action-btn run-stop-btn" title="Run/Stop Task">
                                <span id="taskSettingsRunStopIcon">üîÑ</span>
                                <span id="taskSettingsRunStopText">Run</span>
                            </button>
                            <button id="taskSettingsCloneBtn" class="task-settings-action-btn clone-btn" title="Clone Task">
                                <span>üìã</span>
                                <span>Clone</span>
                            </button>
                            <button id="taskSettingsDeleteBtn" class="task-settings-action-btn delete-btn" title="Delete Task">
                                <span>üóëÔ∏è</span>
                                <span>Delete</span>
                            </button>
                        </div>
                        <div class="header-title-row">
                            <input type="text" id="taskTitle" placeholder="Name of task" class="task-title-input">
                            <button id="closeTaskSettings" class="close-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                    <path d="M18 6 6 18"></path>
                                    <path d="m6 6 12 12"></path>
                                </svg>
                            </button>
                        </div>
                    </div>
                    <div id="taskSettingsError" class="task-settings-error hidden" role="alert" aria-live="polite"></div>
                    
                    <div class="panel-body">
                        <div class="form-section">
                            <label class="form-label">Assigned agent</label>
                            <select id="taskAgent" class="day-select">
                                <option value="">Loading agents...</option>
                            </select>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">Frequency</label>
                            <div class="frequency-group">
                                <button type="button" class="frequency-btn active" data-frequency="once">Once</button>
                                <button type="button" class="frequency-btn" data-frequency="daily">Daily</button>
                                <button type="button" class="frequency-btn" data-frequency="weekly">Weekly</button>
                                <button type="button" class="frequency-btn" data-frequency="monthly">Monthly</button>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">On (UTC timezone)</label>
                            <div class="schedule-controls">
                                    <div id="nowOrDateChoice" class="now-date-choice hidden">
                                        <button type="button" id="nowBtn" class="now-btn active">Now</button>
                                        <button type="button" id="scheduleDateBtn" class="schedule-date-btn">Schedule</button>
                                    </div>
                                    <div class="time-control hidden">
                                        <span class="control-label">Time</span>
                                        <input type="time" id="taskTime" class="time-input" value="12:00">
                                    </div>
                                    <select id="dayOfWeek" class="day-select hidden">
                                        <option value="0">Sunday</option>
                                        <option value="1" selected>Monday</option>
                                        <option value="2">Tuesday</option>
                                        <option value="3">Wednesday</option>
                                        <option value="4">Thursday</option>
                                        <option value="5">Friday</option>
                                        <option value="6">Saturday</option>
                                    </select>
                                    <input type="date" id="taskDate" class="date-input hidden">
                                    <select id="dayOfMonth" class="day-select hidden">
                                        <option value="1" selected>1</option>
                                        <option value="2">2</option>
                                        <option value="3">3</option>
                                        <option value="4">4</option>
                                        <option value="5">5</option>
                                        <option value="6">6</option>
                                        <option value="7">7</option>
                                        <option value="8">8</option>
                                        <option value="9">9</option>
                                        <option value="10">10</option>
                                        <option value="11">11</option>
                                        <option value="12">12</option>
                                        <option value="13">13</option>
                                        <option value="14">14</option>
                                        <option value="15">15</option>
                                        <option value="16">16</option>
                                        <option value="17">17</option>
                                        <option value="18">18</option>
                                        <option value="19">19</option>
                                        <option value="20">20</option>
                                        <option value="21">21</option>
                                        <option value="22">22</option>
                                        <option value="23">23</option>
                                        <option value="24">24</option>
                                        <option value="25">25</option>
                                        <option value="26">26</option>
                                        <option value="27">27</option>
                                        <option value="28">28</option>
                                        <option value="29">29</option>
                                        <option value="30">30</option>
                                        <option value="31">31</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div class="form-section">
                            <label class="form-label">Instructions</label>
                            <textarea id="taskDescription" class="task-description" rows="6" placeholder="Enter task description here"></textarea>
                        </div>

                    
                        <div class="panel-footer">
                            <button id="createTaskBtn" class="create-task-btn">
                                <span class="btn-text">Create Task</span>
                            </button>
                        </div>

                    </div>
                </div>

                <!-- Task Details Panel -->
                <div id="taskDetailsPopup" class="sidebar-panel task-details-panel hidden">
                    <div class="panel-header">
                        <div class="header-title-row">
                            <h2 class="task-details-title" id="taskDetailsTitle">Task Details</h2>
                            <div class="header-buttons">
                                <button id="taskDetailsEditBtn" class="edit-btn-header">
                                    ‚öôÔ∏è
                                </button>
                                <button id="closeTaskDetailsPopup" class="close-btn">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                        <path d="M18 6 6 18"></path>
                                        <path d="m6 6 12 12"></path>
                                    </svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <div class="panel-body">
                        <div class="task-details-meta">
                            <div class="meta-item">
                                <span class="meta-label">Schedule:</span>
                                <span class="meta-value schedule-content" id="taskDetailsSchedule">No schedule set</span>
                            </div>
                            <div class="meta-item">
                                <span class="meta-label">Last Run:</span>
                                <span class="meta-value last-run-content" id="taskDetailsLastRun">Never</span>
                            </div>
                        </div>
                        
                        <div class="task-details-section">
                            <label class="task-details-label">Assigned Agent</label>
                            <div class="task-details-content" id="taskDetailsAgent">
                                No agent assigned
                            </div>
                        </div>
                        
                        <div class="task-details-section">
                            <label class="task-details-label">Description</label>
                            <div class="task-details-content" id="taskDetailsDescription">
                                No description provided.
                            </div>
                        </div>

                        <div class="task-details-section">
                            <div class="responses-header">
                                <label class="task-details-label">Response</label>
                                <div class="responses-header-right">
                                    <button id="deleteResponseBtn" class="response-nav-btn delete-btn" title="Delete response">
                                        üóëÔ∏è
                                    </button>
                                    <div class="response-navigation" id="responseNavigation">
                                        <button class="response-nav-btn" id="prevResponseBtn" title="Previous response">
                                            ‚Äπ
                                        </button>
                                        <span class="response-counter" id="responseCounter">-</span>
                                        <button class="response-nav-btn" id="nextResponseBtn" title="Next response">
                                            ‚Ä∫
                                        </button>
                                    </div>
                                    <button id="latestResponseBtn" class="response-nav-btn latest-btn" title="Go to latest response">
                                        ‚èØÔ∏è
                                    </button>
                                    <button id="taskDetailsChatBtn" class="response-nav-btn chat-btn" title="Chat with task">
                                        üí¨
                                    </button>
                                </div>
                            </div>
                            <div class="response-datetime" id="responseDateTime">
                                No responses yet
                            </div>
                            <div class="task-details-content response-content" id="taskDetailsResponse">
                                This task hasn't been run yet.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Keep delete popup as modal since it's a confirmation dialog -->
    <div id="deletePopup" class="task-popup hidden">
        <div class="popup-overlay"></div>
        <div class="delete-popup-content">
            <div class="delete-header">
                <h2 class="delete-title">Delete Task</h2>
                <button id="closeDeletePopup" class="close-btn">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 6 6 18"></path>
                        <path d="m6 6 12 12"></path>
                    </svg>
                </button>
            </div>
            
            <div class="delete-body">
                <p class="delete-message">Are you sure you want to delete this task?</p>
                <p class="delete-task-name" id="deleteTaskName"></p>
                <p class="delete-warning">This action cannot be undone.</p>
            </div>
            
            <div class="delete-footer">
                <button id="cancelDeleteBtn" class="cancel-delete-btn">Cancel</button>
                <button id="confirmDeleteBtn" class="confirm-delete-btn">Delete Task</button>
            </div>
        </div>
    </div>
</body>
</html>
